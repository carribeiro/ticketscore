<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Counter App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and ReactDOM CDNs -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="module">
        // Import React and ReactDOM from the global scope (loaded via CDN)
        const { useState, useRef, useEffect } = React;
        const ReactDOM = window.ReactDOM;

        // PlayerColumn component
        function PlayerColumn({ playerIndex, score, history, name, onNameChange, isEnabled, onToggleEnabled, colorClass, isSelected, onSelect }) {
            const [isEditingName, setIsEditingName] = useState(false);
            const inputRef = useRef(null);

            useEffect(() => {
                if (isEditingName && inputRef.current) {
                    inputRef.current.focus();
                }
            }, [isEditingName]);

            const handlePlayerNumberClick = (e) => {
                e.stopPropagation();
                if (isEnabled) {
                    setIsEditingName(true);
                }
            };

            const handleInputChange = (e) => {
                onNameChange(playerIndex, e.target.value);
            };

            const handleInputBlur = () => {
                setIsEditingName(false);
            };

            const handleInputKeyDown = (e) => {
                if (e.key === 'Enter') {
                    setIsEditingName(false);
                }
            };

            const handleCheckboxChange = (e) => {
                e.stopPropagation();
                onToggleEnabled(playerIndex);
            };

            return (
                React.createElement("div", {
                    className: `relative flex-1 flex flex-col items-center justify-center p-4 transition-all duration-200 ease-in-out
                                ${isSelected ? 'bg-indigo-200 border-4 border-indigo-500' : 'bg-white border border-gray-200'}
                                rounded-lg m-1 shadow-md text-center
                                ${!isEnabled ? 'opacity-50 grayscale pointer-events-none' : 'cursor-pointer'}`,
                    onClick: () => onSelect(playerIndex)
                },
                    React.createElement("div", { className: "absolute top-2 right-2 z-10 pointer-events-auto" },
                        React.createElement("input", {
                            type: "checkbox",
                            checked: isEnabled,
                            onChange: handleCheckboxChange,
                            className: "form-checkbox h-5 w-5 text-indigo-600 rounded"
                        })
                    ),
                    React.createElement("div", {
                        className: `text-3xl font-bold text-white p-2 rounded-full w-12 h-12 flex items-center justify-center mb-2 ${colorClass} ${isEnabled ? 'cursor-pointer' : ''}`,
                        onClick: handlePlayerNumberClick
                    },
                        playerIndex + 1
                    ),
                    isEditingName && isEnabled ? (
                        React.createElement("input", {
                            ref: inputRef,
                            type: "text",
                            value: name,
                            onChange: handleInputChange,
                            onBlur: handleInputBlur,
                            onKeyDown: handleInputKeyDown,
                            className: "text-xl font-semibold text-gray-700 mb-2 w-full text-center border-b-2 border-indigo-500 focus:outline-none bg-transparent",
                            placeholder: `Player ${playerIndex + 1}`,
                            maxLength: "15",
                            disabled: !isEnabled
                        })
                    ) : (
                        React.createElement("div", { className: "text-xl font-semibold text-gray-700 mb-2 truncate max-w-full" },
                            name || `Player ${playerIndex + 1}`
                        )
                    ),
                    React.createElement("div", { className: "text-5xl font-extrabold text-gray-800" },
                        score
                    ),
                    React.createElement("div", { className: "text-sm text-gray-600 mt-1 h-8 overflow-hidden" },
                        history.length > 0 ? (
                            React.createElement("span", { className: "break-words" },
                                history.join(', ')
                            )
                        ) : (
                            React.createElement("span", { className: "text-gray-400" }, "No points yet")
                        )
                    ),
                    isSelected && (
                        React.createElement("div", { className: "mt-2 text-sm font-semibold text-indigo-700" },
                            "Selected"
                        )
                    )
                )
            );
        }

        // KeyButton component
        function KeyButton({ value, onClick }) {
            return (
                React.createElement("button", {
                    className: "bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-lg shadow-lg transition-transform transform active:scale-95 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75 text-2xl",
                    onClick: () => onClick(value)
                },
                    "+" + value
                )
            );
        }

        // Main App component
        function App() {
            const [scores, setScores] = useState(
                Array(5).fill().map((_, i) => ({ score: 0, history: [], name: `Player ${i + 1}`, isEnabled: true }))
            );
            const [selectedPlayer, setSelectedPlayer] = useState(null);

            const playerColors = [
                'bg-red-500',
                'bg-blue-500',
                'bg-green-500',
                'bg-yellow-500',
                'bg-black',
            ];

            const handleAddPoints = (points) => {
                if (selectedPlayer !== null && scores[selectedPlayer].isEnabled) {
                    setScores(prevScores => {
                        const newScores = [...prevScores];
                        newScores[selectedPlayer] = {
                            ...newScores[selectedPlayer],
                            score: newScores[selectedPlayer].score + points,
                            history: [...newScores[selectedPlayer].history, points]
                        };
                        return newScores;
                    });
                }
            };

            const handlePlayerSelect = (index) => {
                if (scores[index].isEnabled) {
                    setSelectedPlayer(index);
                }
            };

            const handlePlayerNameChange = (index, newName) => {
                setScores(prevScores => {
                    const newScores = [...prevScores];
                    newScores[index] = {
                        ...newScores[index],
                        name: newName,
                    };
                    return newScores;
                });
            };

            const handleTogglePlayerEnabled = (index) => {
                setScores(prevScores => {
                    const newScores = [...prevScores];
                    const newIsEnabled = !newScores[index].isEnabled;
                    newScores[index] = {
                        ...newScores[index],
                        isEnabled: newIsEnabled,
                    };
                    if (selectedPlayer === index && !newIsEnabled) {
                        setSelectedPlayer(null);
                    }
                    return newScores;
                });
            };

            const handleResetScores = () => {
                setScores(Array(5).fill().map((_, i) => ({ score: 0, history: [], name: `Player ${i + 1}`, isEnabled: true })));
                setSelectedPlayer(null);
            };

            return (
                React.createElement("div", { className: "min-h-screen flex flex-col font-sans bg-gray-100" },
                    React.createElement("div", { className: "flex flex-1 w-full overflow-hidden" },
                        scores.map((playerData, index) =>
                            React.createElement(PlayerColumn, {
                                key: index,
                                playerIndex: index,
                                score: playerData.score,
                                history: playerData.history,
                                name: playerData.name,
                                onNameChange: handlePlayerNameChange,
                                isEnabled: playerData.isEnabled,
                                onToggleEnabled: handleTogglePlayerEnabled,
                                colorClass: playerColors[index],
                                isSelected: selectedPlayer === index,
                                onSelect: handlePlayerSelect
                            })
                        )
                    ),
                    React.createElement("div", { className: "w-full p-4 bg-gray-800 grid grid-cols-3 gap-4 md:grid-cols-6" },
                        React.createElement(KeyButton, { value: 1, onClick: handleAddPoints }),
                        React.createElement(KeyButton, { value: 2, onClick: handleAddPoints }),
                        React.createElement(KeyButton, { value: 4, onClick: handleAddPoints }),
                        React.createElement(KeyButton, { value: 7, onClick: handleAddPoints }),
                        React.createElement(KeyButton, { value: 10, onClick: handleAddPoints }),
                        React.createElement(KeyButton, { value: 15, onClick: handleAddPoints }),
                        React.createElement("button", {
                            className: "col-span-3 md:col-span-6 bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-6 rounded-lg shadow-lg transition-transform transform active:scale-95 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-75 text-2xl mt-4",
                            onClick: handleResetScores
                        },
                            "Reset Scores"
                        )
                    )
                )
            );
        }

        // Render the App component
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App, null));
    </script>
</body>
</html>
